## Технические спецификации

- Async FastAPI/SQLAlchemy/httpx. Таймауты+backoff.
- Мультиарендность: мидлварь, индексы; (опция) PostgreSQL RLS.
- Идемпотентность: `Idempotency-Key`, ключи задач.
- Observability: JSON‑логи, Prometheus, OTEL, Sentry.
- Квоты: Sheets/МС троттлинг через Redis семафоры.
- Биллинг: лимиты строк/час/конфигов, soft/hard.

Кросс‑компанийные:
- Парное подключение через `CompanyLink` (двустороннее подтверждение по `company_id`).
- `AutomationRule` определяет допустимые «что передаём» и «что создаём у партнёра».
- Идемпотентность по (source_id, rule_id). Аудит и отладочные логи обязательны.

Telegram:
- Бот, хранение chat_id в `Dealer`, шаблоны сообщений, ретраи и троттлинг.


